<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <script>
        // function deepClone(origin, target) {
        //     var tar = target || {};
        //     var toStr = Object.prototype.toString;
        //     var arrType = '[object Array]';
        //     for (var k in origin) {
        //         if (origin.hasOwnProperty(k)) {
        //             if (typeof origin[k] === 'object' && origin[k] !== null) {
        //                 tar[k] = toStr.call(origin[k]) === arrType ? [] : {};
        //                 deepClone(origin[k], tar[k]);
        //             } else {
        //                 tar[k] = origin[k];
        //             }
        //         }
        //     }
        //     return tar;
        // }

        
        //forEach 第二个参数改变this指向
        var obj = {
            name: 'Jacky',
            age: 3
        }
        arr = [
            {
                name: '张三',
                age: 20
            },
            {
                name: '李五',
                age: 15
            },
            {
                name: '王二',
                age: 10
            }
        ]

        Array.prototype.myForEach = function (cd) {
            var _arr = this;
            var _len = _arr.length;
            var _arg2 = arguments[1] || window;
            for (var i = 0; i < _len; i++) {
                cd.apply(_arg2, [_arr[i], i, _arr])
            }
        }

        // arr.forEach(function(item,index,array){
        //     console.log(this.name);
        //     console.log(item,index,array)
        // },obj);

        // arr.myForEach(function(item,index,array){
        //     console.log(this.name);
        //     console.log(item,index,array)
        // },obj);


        Array.prototype.myMap = function (cd) {
            var _arr = this;
            var _len = _arr.length;
            var _arg2 = arguments[1] || window;
            var _newArr = [];
            var _item;
            for (var i = 0; i < _len; i++) {
                _item = deepClone(arr[i])
                _newArr.push(cd.apply(_arg2, [_item, i, _arr]));
            }
            return _newArr;
        }

        var newArr = arr.map(function (item, index, array) {
            item.age += 100;
            item.name = obj.name;
            return item;
        }, obj)
        console.log(newArr);
        var newArr = arr.myMap(function (item, index, array) {
            item.age += 100;
            item.name = obj.name;
            return item;
        }, obj)
        console.log(newArr);
    </script>
</body>

</html>