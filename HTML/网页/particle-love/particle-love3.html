<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="particle-love3.css">
    <script>
        window.onload = function () {
            var timer;
            var text = document.getElementsByClassName('floor_text')[0];

            var left = document.getElementsByClassName('lefter');
            var index = 1;

            var oldValue;
            function move(obj, target, speed) {
                clearInterval(timer);

                timer = setInterval(function () {
                    // if(index !== 1){
                    //     // left[0].style.backgroundColor = 'green';
                    //     // left[0].firstChild.style.backgroundColor = 'green';
                    //     // left[0].firstChild.style.color="#ccc";
                    // }
                    var oldValue = parseInt(text.offsetLeft);
                    var newValue = oldValue + speed;
                    if (newValue < target && speed < 0) {
                        clearInterval(timer);
                    }
                    else if (newValue > target && speed > 0) {
                        clearInterval(timer);
                    }
                    else obj.style.left = newValue + "px";
                }, 30);
            }
            left[0].onclick = function () {
                var oldValue = parseInt(text.offsetLeft);
                if (index >= 5);
                else {
                    move(text, oldValue - 200, -10);
                    index++;
                }
            }
            left[1].onclick = function () {
                var oldValue = parseInt(text.offsetLeft);
                if (index <= 1);
                else {
                    move(text, oldValue + 200, 10);
                    index--;
                }
            }

            var post_covers = document.getElementsByClassName("post_cover");
        for (var i = 0; i < post_covers.length; i++) {
            post_covers[i].onmouseenter = function (event) {
                event = event || window.event;
                mouseDirection(this, event);
            }

            post_covers[i].onmouseleave = function (event) {
                event = event || window.event;
                mouseDirection(this, event);
            }
        }

        
        for (var i = 0; i < post_covers.length; i++) {
            post_covers[i].onmouseenter = function (event) {
                event = event || window.event;
                var post_mask = this;
                // 必须要把之前的离开 class 删除, 否则再进来就有问题.
                post_mask.classList.remove("leave-top", "leave-bottom", "leave-left", "leave-right");
                mouseDirection(this, event, function (dir) {
                    console.log("enter-" + dir)
                    post_mask.classList.add("enter-" + dir);
                })
            }
            

            post_covers[i].onmouseleave = function (ev) {
                ev = ev || window.event;
                var post_mask = this;
                post_mask.classList.remove("enter-left", "enter-right", "enter-top", "enter-bottom");

                mouseDirection(this, event, function (dir) {
                    console.log("leave-" + dir);
                    post_mask.classList.add("leave-" + dir);
                })
            }
        }

        for (var i = 0; i < post_covers.length; i++) {
            post_covers[i].onmouseenter = function (ev) {
                ev = ev || window.event;
                var post_mask = this;
                // 必须要把之前的离开 class 删除, 否则再进来就有问题.
                post_mask.classList.remove("leave-top", "leave-bottom", "leave-left", "leave-right");
                mouseDirection(this, ev, function (dir) {
                    console.log("enter-" + dir);
                    post_mask.classList.add("enter-" + dir);
                })
            }

            post_covers[i].onmouseleave = function (ev) {
                ev = ev || window.event;
                var post_mask = this;
                post_mask.classList.remove("enter-left", "enter-right", "enter-top", "enter-bottom");

                mouseDirection(this, ev, function (dir) {
                    console.log("leave-" + dir);
                    post_mask.classList.add("leave-" + dir);
                })
            }
        }

        function mouseDirection(wrap, ev, fn) {
            var dirs = ["top", "right", "bottom", "left"];
            var w = wrap.offsetWidth;
            var h = wrap.offsetHeight;
            var x = (ev.pageX - wrap.getBoundingClientRect().left - (w / 2)) * (w > h ? (h / w) : 1);
            var y = (ev.pageY - wrap.getBoundingClientRect().top - (h / 2)) * (h > w ? (w / h) : 1);
            // var direction = Math.round((((Math.atan2(y, x) * 180 / Math.PI) + 180) / 90) + 3) % 4;
            var direction = parseInt(((Math.atan2(y, x) * 180 / Math.PI) + 180) / 90);
            console.log(direction);
            if (fn) {
                fn(dirs[direction]);
            } 
        }
        }
    </script>
</head>

<body>
    <div class="center_top">
        <div class="text">P A R T I C L E &nbsp; L O V E</div>
        <div class="text_2">B Y &nbsp; E D A N &nbsp; K W A N</div>
    </div>
    <div class="center_bottom">
        <div class="three_pic">
            <div class="pic_1 post_cover" id="div1">
                <div class="top"></div>
                <div class="bottom"></div>
                <div class="left"></div>
                <div class="right"></div>
                
                <div class="pic_text nomove">Go</div>
                <div class="lefter nomove">
                    <div class="left_1">
            
                    </div>
                    <div class="left_2">
            
                    </div>
                </div>
                <div class="lefter nomove">
                    <div class="right_1">

                    </div>
                    <div class="right_2">

                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="bottomer">
        <div class="floor_text">
            <div>The Spirit</div>
            <div>Icicle Bubbles</div>
            <div>Hyper Mix</div>
            <div>Constraint</div>
            <div>Touch with Leap Motion</div>
        </div>
    </div>
    
</body>
<!-- var direction = Math.round( ( ( Math.atan2(posY,posX) * (180/Math.PI) + 180 ) /90 )+3 )%4; -->

</html>